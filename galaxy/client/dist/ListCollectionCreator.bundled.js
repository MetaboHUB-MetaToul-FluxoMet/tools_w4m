"use strict";(self.webpackChunk_galaxyproject_galaxy_client=self.webpackChunk_galaxyproject_galaxy_client||[]).push([[199],{93863:(e,t,n)=>{n.r(t),n.d(t,{default:()=>z});var l=n(70538),a=n(55806),i=n.n(a),o=i();i().fn.extend({hoverhighlight:function(e,t){return e=e||"body",this.length?(o(this).each((function(){var n=o(this),l=n.data("target");l&&n.mouseover((n=>{o(l,e).css({background:t})})).mouseout((e=>{o(l).css({background:""})}))})),this):this}});var s=n(9382),c=n(51436),r=n(57810),d=n(73106),u=n(15193),m=n(82021),v=n.n(m),_=n(13164),f=n(11411),p=n(64268),h=n(34396);const g=(0,l.defineComponent)({__name:"ListDatasetCollectionElementView",props:{element:null},emits:["onRename","element-is-selected","element-is-discarded"],setup(e,{emit:t}){const n=e,a=(0,l.ref)("");return(0,l.watch)(a,(()=>{t("onRename",a.value)})),(0,l.onMounted)((()=>{a.value=n.element.name})),{__sfc:!0,props:n,emit:t,elementName:a,clickDiscard:function(){t("element-is-discarded",n.element)},localize:f.ZP,ClickToEdit:h.Z}}});var b=n(51900);const k=(0,b.Z)(g,(function(){var e=this,t=e._self._c,n=e._self._setupProxy;return t("div",{staticClass:"collection-element",on:{click:function(t){return n.emit("element-is-selected",e.element)}}},[t(n.ClickToEdit,{attrs:{title:n.localize("Click to rename")},model:{value:n.elementName,callback:function(e){n.elementName=e},expression:"elementName"}}),e._v(" "),t("button",{staticClass:"discard-btn btn-sm",attrs:{title:n.localize("Remove this dataset from the list")},on:{click:n.clickDiscard}},[e._v("\n        "+e._s(n.localize("Discard"))+"\n    ")])],1)}),[],!1,null,"52ba2a99",null).exports,y=(0,l.defineComponent)({__name:"ListCollectionCreator",props:{initialElements:null,oncancel:null,oncreate:null,creationFn:null,defaultHideSourceItems:{type:Boolean}},emits:["clicked-create"],setup(e,{emit:t}){const n=e;s.vI.add(c.tHg,c.X7o);const a=(0,l.ref)("build"),i=(0,l.ref)([]),o=(0,l.ref)([]),m=(0,l.ref)([]),h=(0,l.ref)([]),g=(0,l.ref)([]),b=(0,l.ref)(n.defaultHideSourceItems||!1),y=(0,l.computed)((()=>g.value.length>0)),z=(0,l.computed)((()=>g.value)),w=(0,l.computed)((()=>0==h.value.length)),C=(0,l.computed)((()=>m.value.length>0)),E=(0,l.computed)((()=>m.value)),S=(0,l.computed)((()=>0==n.initialElements.length)),D=(0,l.computed)((()=>o.value.length>0)),x=(0,l.computed)((()=>n.initialElements.length==m.value.length));function I(){g.value=[]}function A(){m.value=[],h.value=[],h.value=JSON.parse(JSON.stringify(n.initialElements.slice(0))),N(),O(),j()}function N(){return h.value.forEach((e=>{Object.prototype.hasOwnProperty.call(e,"id")||console.warn("Element missing id",e)})),h.value}function O(){return h.value=h.value.filter((e=>{var t=B(e);return t&&m.value.push(e.name+"  "+t),!t})),h.value}function B(e){return"dataset_collection"===e.history_content_type?(0,f.ZP)("is a collection, this is not allowed"):e.state===_.Z.OK||_.Z.NOT_READY_STATES.includes(e.state)?e.deleted||e.purged?(0,f.ZP)("has been deleted or purged"):null:(0,f.ZP)("has errored, is paused, or is not accessible")}function j(){var e=1,t={};h.value.forEach((n=>{for(var l=n.name;Object.prototype.hasOwnProperty.call(t,l);)l=`${n.name} (${e})`,e+=1;n.name=l,t[n.name]=!0}))}function P(){i.value=JSON.parse(JSON.stringify(h.value))}function T(){h.value=JSON.parse(JSON.stringify(i.value))}function Z(){var e=!0,t={};o.value=[],h.value.forEach((n=>{Object.prototype.hasOwnProperty.call(t,n.name)&&(e=!1,o.value.push(n.name)),t[n.name]=!0})),a.value=e?"build":"error"}function F(e,t){return e.name&&t.name&&e.name<t.name?-1:e.name&&t.name&&e.name>t.name?1:0}return(0,l.onMounted)((()=>{I(),A(),P()})),{__sfc:!0,props:n,emit:t,state:a,originalNamedElements:i,duplicateNames:o,invalidElements:m,workingElements:h,selectedDatasetElements:g,hideSourceItems:b,atLeastOneDatasetIsSelected:y,getSelectedDatasetElements:z,noMoreValidDatasets:w,returnInvalidElementsLength:C,returnInvalidElements:E,noElementsSelected:S,showDuplicateError:D,allElementsAreInvalid:x,_instanceSetUp:I,_elementsSetUp:A,_ensureElementIds:N,_validateElements:O,_isElementInvalid:B,_mangleDuplicateNames:j,saveOriginalNames:P,getOriginalNames:T,elementSelected:function(e){g.value.includes(e.id)?g.value.splice(g.value.indexOf(e.id),1):g.value.push(e.id)},elementDiscarded:function(e){return h.value.splice(h.value.indexOf(e),1),h.value},clickClearAll:function(){g.value=[]},clickedCreate:function(e){if(Z(),"error"!==a.value)return t("clicked-create",h.value,e,b.value),n.creationFn(h.value,e,b.value).done(n.oncreate).fail((()=>{a.value="error"}))},checkForDuplicates:Z,reset:function(){I(),T()},sortByName:function(){h.value.sort(F)},compareNames:F,onUpdateHideSourceItems:function(e){b.value=e},faSortAlphaDown:c.tHg,faUndo:c.X7o,FontAwesomeIcon:r.GN,BAlert:d.F,BButton:u.T,draggable:v(),localize:f.ZP,CollectionCreator:p.Z,DatasetCollectionElementView:k}}});const z=(0,b.Z)(y,(function(){var e=this,t=e._self._c,n=e._self._setupProxy;return t("div",{staticClass:"list-collection-creator"},["error"==n.state?t("div",[t(n.BAlert,{attrs:{show:"",variant:"danger"}},[e._v("\n            "+e._s(n.localize("Galaxy could not be reached and may be updating.  Try again in a few minutes."))+"\n        ")])],1):t("div",[n.noElementsSelected?t("div",[t(n.BAlert,{attrs:{show:"",variant:"warning",dismissible:""}},[e._v("\n                "+e._s(n.localize("No datasets were selected"))+"\n                "+e._s(n.localize("At least one element is needed for the collection. You may need to"))+"\n                "),t("a",{staticClass:"cancel-text",attrs:{href:"javascript:void(0)",role:"button"},on:{click:e.oncancel}},[e._v("\n                    "+e._s(n.localize("cancel"))+"\n                ")]),e._v("\n                "+e._s(n.localize("and reselect new elements."))+"\n            ")]),e._v(" "),t("div",{staticClass:"float-left"},[t("button",{staticClass:"cancel-create btn",attrs:{tabindex:"-1"},on:{click:e.oncancel}},[e._v("\n                    "+e._s(n.localize("Cancel"))+"\n                ")])])],1):n.allElementsAreInvalid?t("div",[t(n.BAlert,{attrs:{show:"",variant:"warning",dismissible:""}},[e._v("\n                "+e._s(n.localize("The following selections could not be included due to problems:"))+"\n                "),t("ul",e._l(n.returnInvalidElements,(function(n){return t("li",{key:n},[e._v("\n                        "+e._s(n)+"\n                    ")])})),0),e._v("\n                "+e._s(n.localize("At least one element is needed for the collection. You may need to"))+"\n                "),t("a",{staticClass:"cancel-text",attrs:{href:"javascript:void(0)",role:"button"},on:{click:e.oncancel}},[e._v("\n                    "+e._s(n.localize("cancel"))+"\n                ")]),e._v("\n                "+e._s(n.localize("and reselect new elements."))+"\n            ")]),e._v(" "),t("div",{staticClass:"float-left"},[t("button",{staticClass:"cancel-create btn",attrs:{tabindex:"-1"},on:{click:e.oncancel}},[e._v("\n                    "+e._s(n.localize("Cancel"))+"\n                ")])])],1):t("div",[n.returnInvalidElementsLength?t("div",[t(n.BAlert,{attrs:{show:"",variant:"warning",dismissible:""}},[e._v("\n                    "+e._s(n.localize("The following selections could not be included due to problems:"))+"\n                    "),t("ul",e._l(n.returnInvalidElements,(function(n){return t("li",{key:n},[e._v("\n                            "+e._s(n)+"\n                        ")])})),0)])],1):e._e(),e._v(" "),n.showDuplicateError?t("div",[t(n.BAlert,{attrs:{show:"",variant:"danger"}},[e._v("\n                    "+e._s(n.localize("Collections cannot have duplicated names. The following list names are duplicated: "))+"\n                    "),t("ol",e._l(n.duplicateNames,(function(n){return t("li",{key:n},[e._v(e._s(n))])})),0),e._v("\n                    "+e._s(n.localize("Please fix these duplicates and try again."))+"\n                ")])],1):e._e(),e._v(" "),t(n.CollectionCreator,{attrs:{oncancel:e.oncancel,"hide-source-items":n.hideSourceItems},on:{onUpdateHideSourceItems:n.onUpdateHideSourceItems,"clicked-create":n.clickedCreate},scopedSlots:e._u([{key:"help-content",fn:function(){return[t("p",[e._v("\n                        "+e._s(n.localize(["Collections of datasets are permanent, ordered lists of datasets that can be passed to tools ","and workflows in order to have analyses done on each member of the entire group. This interface allows ","you to create a collection and re-order the final collection."].join("")))+"\n                    ")]),e._v(" "),t("ul",[t("li",[e._v("\n                            "+e._s(n.localize("Rename elements in the list by clicking on"))+"\n                            "),t("i",{attrs:{"data-target":".collection-element .name"}},[e._v("\n                                "+e._s(n.localize("the existing name"))+"\n                            ")]),e._v("\n                            "+e._s(n.localize("."))+"\n                        ")]),e._v(" "),t("li",[e._v("\n                            "+e._s(n.localize("Discard elements from the final created list by clicking on the "))+"\n                            "),t("i",{attrs:{"data-target":".collection-element .discard"}},[e._v("\n                                "+e._s(n.localize("Discard"))+"\n                            ")]),e._v("\n                            "+e._s(n.localize("button."))+"\n                        ")]),e._v(" "),t("li",[e._v("\n                            "+e._s(n.localize("Reorder the list by clicking and dragging elements. Select multiple elements by clicking on"))+"\n                            "),t("i",{attrs:{"data-target":".collection-element"}},[e._v("\n                                "+e._s(n.localize("them"))+"\n                            ")]),e._v("\n                            "+e._s(n.localize("and you can then move those selected by dragging the entire group. Deselect them by clicking them again or by clicking the"))+"\n                            "),t("i",{attrs:{"data-target":".clear-selected"}},[e._v("\n                                "+e._s(n.localize("Clear selected"))+"\n                            ")]),e._v("\n                            "+e._s(n.localize("link."))+"\n                        ")]),e._v(" "),t("li",[e._v("\n                            "+e._s(n.localize("Click "))+"\n                            "),t("i",{attrs:{"data-target":".reset"}},[t(n.FontAwesomeIcon,{attrs:{icon:n.faUndo}})],1),e._v("\n                            "+e._s(n.localize("to begin again as if you had just opened the interface."))+"\n                        ")]),e._v(" "),t("li",[e._v("\n                            "+e._s(n.localize("Click "))+"\n                            "),t("i",{attrs:{"data-target":".sort-items"}},[t(n.FontAwesomeIcon,{attrs:{icon:n.faSortAlphaDown}})],1),e._v("\n                            "+e._s(n.localize("to sort datasets alphabetically."))+"\n                        ")]),e._v(" "),t("li",[e._v("\n                            "+e._s(n.localize("Click the"))+"\n                            "),t("i",{attrs:{"data-target":".cancel-create"}},[e._v("\n                                "+e._s(n.localize("Cancel"))+"\n                            ")]),e._v("\n                            "+e._s(n.localize("button to exit the interface."))+"\n                        ")])]),e._v(" "),t("br"),e._v(" "),t("p",[e._v("\n                        "+e._s(n.localize("Once your collection is complete, enter a "))+"\n                        "),t("i",{attrs:{"data-target":".collection-name"}},[e._v("\n                            "+e._s(n.localize("name"))+"\n                        ")]),e._v("\n                        "+e._s(n.localize("and click"))+"\n                        "),t("i",{attrs:{"data-target":".create-collection"}},[e._v("\n                            "+e._s(n.localize("Create list"))+"\n                        ")]),e._v("\n                        "+e._s(n.localize("."))+"\n                    ")])]},proxy:!0},{key:"middle-content",fn:function(){return[t("div",{staticClass:"collection-elements-controls"},[t(n.BButton,{staticClass:"reset",attrs:{title:n.localize("Undo all reordering and discards")},on:{click:n.reset}},[t(n.FontAwesomeIcon,{attrs:{icon:n.faUndo}})],1),e._v(" "),t(n.BButton,{staticClass:"sort-items",attrs:{title:n.localize("Sort datasets by name")},on:{click:n.sortByName}},[t(n.FontAwesomeIcon,{attrs:{icon:n.faSortAlphaDown}})],1),e._v(" "),n.atLeastOneDatasetIsSelected?t("a",{staticClass:"clear-selected",attrs:{href:"javascript:void(0);",role:"button",title:n.localize("De-select all selected datasets")},on:{click:n.clickClearAll}},[e._v("\n                            "+e._s(n.localize("Clear selected"))+"\n                        ")]):e._e()],1),e._v(" "),t(n.draggable,{staticClass:"collection-elements scroll-container flex-row drop-zone",on:{start:function(t){e.drag=!0},end:function(t){e.drag=!1}},model:{value:n.workingElements,callback:function(e){n.workingElements=e},expression:"workingElements"}},[n.noMoreValidDatasets?t("div",[t(n.BAlert,{attrs:{show:"",variant:"warning",dismissible:""}},[e._v("\n                                "+e._s(n.localize("No elements left. Would you like to"))+"\n                                "),t("a",{staticClass:"reset-text",attrs:{href:"javascript:void(0)",role:"button"},on:{click:n.reset}},[e._v("\n                                    "+e._s(n.localize("start over"))+"\n                                ")]),e._v("\n                                ?\n                            ")])],1):e._l(n.workingElements,(function(e){return t(n.DatasetCollectionElementView,{key:e.id,class:{selected:n.getSelectedDatasetElements.includes(e.id)},attrs:{element:e},on:{"element-is-selected":n.elementSelected,"element-is-discarded":n.elementDiscarded,onRename:t=>e.name=t}})}))],2)]},proxy:!0}])})],1)])])}),[],!1,null,"037cb06f",null).exports}}]);
//# sourceMappingURL=ListCollectionCreator.bundled.js.map